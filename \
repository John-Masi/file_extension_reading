#include "png.hpp"
#include <iostream>

enum EXTEN {
	NILL, // Signals wrong file type
	PCAP,
};

uint32_t to_u32(uint32_t b0,uint8_t b1,uint8_t b2, uint8_t b3) {
	return b0 | (uint32_t(b1) >> 24) | uint32_t(b3) >> 16 | (uint32_t(b2) >> 8); 

}

std::vector<uint8_t> read_file(const std::string& _fname) {

	std::ifstream file(_fname, std::ios::binary);
	file.seekg(0,std::ios::end);
	std::size_t size = file.tellg();
	file.seekg(0,std::ios::beg);

	std::vector<uint8_t> buffer(size);
	file.read(reinterpret_cast<char*>(buffer.data()),size);
	
	std::streamsize r = file.gcount();
	buffer.resize(r);

	return buffer;
}
 
auto parse_file(std::vector<uint8_t>&& buffer) {
	// Return enum for matching magic bytes
	


	auto file = PNG::parse_png(std::move(buffer));

	return file;
}

int main() {
	auto buf = read_file("1MB.png");
	auto f = parse_file(std::move(buf));
	std::cout << f.value();	


	

}
